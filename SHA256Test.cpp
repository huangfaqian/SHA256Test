// SHA256Test.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include "SHA256.h"

extern "C" void SHA256D(void);

int _tmain(int argc, _TCHAR* argv[])
{
    /*unsigned char test1[3];*/
    unsigned char test2[80] = 
    {
        0x01, 0x00, 0x00, 0x00, // 4
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // 32
        0x3B, 0xA3, 0xED, 0xFD, 0x7A, 0x7B, 0x12, 0xB2, 0x7A, 0xC7, 0x2C, 0x3E, 0x67, 0x76, 0x8F, 0x61,
        0x7F, 0xC8, 0x1B, 0xC3, 0x88, 0x8A, 0x51, 0x32, 0x3A, 0x9F, 0xB8, 0xAA, 0x4B, 0x1E, 0x5E, 0x4A, // 32
        0x29, 0xAB, 0x5F, 0x49, // 4
        0xFF, 0xFF, 0x00, 0x1D, // 4
        0x1D, 0xAC, 0x2B, 0x7C  // 4
    };
    unsigned char result[32];
    unsigned char result1[32];
    SHA256 SHA256Test;

    /*memcpy(test1, "abc", 3);*/
    SHA256D();
    SHA256Test.Update(test2, sizeof test2);
    SHA256Test.Finalize(result);

    SHA256Test.Reset();
    SHA256Test.Update(result, sizeof result);
    SHA256Test.Finalize(result1);
	return 0;
}

